server/middleware/securityMonitoring.ts(26,26): error TS2339: Property 'jti' does not exist on type '{ id: number; name: string | null; email: string; password: string | null; plan: string; firstName: string | null; searchCount: number; lastResetDate: string; createdAt: string | null; updatedAt: string | null; ... 19 more ...; passwordStrengthScore: number; }'.
server/middleware/securityMonitoring.ts(40,3): error TS2322: Type '(chunk?: any, encoding?: any) => void' is not assignable to type '{ (cb?: (() => void) | undefined): Response<any, Record<string, any>>; (chunk: any, cb?: (() => void) | undefined): Response<any, Record<string, any>>; (chunk: any, encoding: BufferEncoding, cb?: (() => void) | undefined): Response<...>; }'.
  Type 'void' is not assignable to type 'Response<any, Record<string, any>>'.
server/middleware/sessionManagement.ts(12,32): error TS2339: Property 'jti' does not exist on type '{ id: number; name: string | null; email: string; password: string | null; plan: string; firstName: string | null; searchCount: number; lastResetDate: string; createdAt: string | null; updatedAt: string | null; ... 19 more ...; passwordStrengthScore: number; }'.
server/middleware/sessionManagement.ts(16,32): error TS2339: Property 'jti' does not exist on type '{ id: number; name: string | null; email: string; password: string | null; plan: string; firstName: string | null; searchCount: number; lastResetDate: string; createdAt: string | null; updatedAt: string | null; ... 19 more ...; passwordStrengthScore: number; }'.
server/middleware/sessionManagement.ts(23,7): error TS2739: Type '{ id: string; deviceInfo: DeviceInfo; ipAddress: string; issuedAt: Date; expiresAt: Date; }' is missing the following properties from type '{ id: string; userId: number; deviceInfo: DeviceInfo; ipAddress: string; issuedAt: Date; expiresAt: Date; lastActivity: Date; isActive: boolean; }': userId, lastActivity, isActive
server/routes.ts(164,19): error TS2304: Cannot find name 'generalRateLimit'.
server/routes.ts(208,75): error TS2322: Type 'number' is not assignable to type 'string'.
server/routes.ts(485,50): error TS2345: Argument of type 'number' is not assignable to parameter of type 'string'.
server/routes.ts(530,9): error TS2322: Type 'number' is not assignable to type 'string'.
server/routes.ts(624,10): error TS2345: Argument of type 'number' is not assignable to parameter of type 'string'.
server/routes.ts(736,9): error TS2322: Type 'string' is not assignable to type 'number'.
server/routes/admin.ts(97,42): error TS2345: Argument of type 'number' is not assignable to parameter of type 'string'.
server/routes/admin.ts(214,23): error TS2339: Property 'updatePassword' does not exist on type 'AuthService'.
server/routes/auth.ts(198,31): error TS2339: Property 'jti' does not exist on type '{ id: number; name: string | null; email: string; password: string | null; plan: string; firstName: string | null; searchCount: number; lastResetDate: string; createdAt: string | null; updatedAt: string | null; ... 19 more ...; passwordStrengthScore: number; }'.
server/routes/auth.ts(284,38): error TS2339: Property 'jti' does not exist on type '{ id: number; name: string | null; email: string; password: string | null; plan: string; firstName: string | null; searchCount: number; lastResetDate: string; createdAt: string | null; updatedAt: string | null; ... 19 more ...; passwordStrengthScore: number; }'.
server/routes/security.ts(47,40): error TS2339: Property 'jti' does not exist on type '{ id: number; name: string | null; email: string; password: string | null; plan: string; firstName: string | null; searchCount: number; lastResetDate: string; createdAt: string | null; updatedAt: string | null; ... 19 more ...; passwordStrengthScore: number; }'.
server/routes/securityMonitoring.ts(55,59): error TS2345: Argument of type '{ offset: number; limit: number; userId?: number | undefined; ipAddress?: string | undefined; eventType?: string | undefined; success?: boolean | undefined; severity?: "error" | "info" | "critical" | "warning" | undefined; startDate?: Date | undefined; endDate?: Date | undefined; }' is not assignable to parameter of type '{ limit?: number | undefined; offset?: number | undefined; eventType?: SecurityEventType | undefined; userId?: number | undefined; ipAddress?: string | undefined; severity?: string | undefined; success?: boolean | undefined; startDate?: Date | undefined; endDate?: Date | undefined; }'.
  Types of property 'eventType' are incompatible.
    Type 'string | undefined' is not assignable to type 'SecurityEventType | undefined'.
      Type 'string' is not assignable to type 'SecurityEventType | undefined'.
server/routes/securityMonitoring.ts(79,59): error TS2345: Argument of type '{ offset: number; limit: number; status?: "open" | "resolved" | "false_positive" | "investigating" | undefined; severity?: "high" | "low" | "medium" | "critical" | undefined; alertType?: string | undefined; startDate?: Date | undefined; endDate?: Date | undefined; }' is not assignable to parameter of type '{ limit?: number | undefined; offset?: number | undefined; alertType?: SecurityAlertType | undefined; severity?: string | undefined; status?: string | undefined; startDate?: Date | undefined; endDate?: Date | undefined; }'.
  Types of property 'alertType' are incompatible.
    Type 'string | undefined' is not assignable to type 'SecurityAlertType | undefined'.
      Type 'string' is not assignable to type 'SecurityAlertType | undefined'.
server/routes/securityMonitoring.ts(158,59): error TS2345: Argument of type '{ userId: number; offset: number; limit: number; ipAddress?: string | undefined; eventType?: string | undefined; success?: boolean | undefined; severity?: "error" | "info" | "critical" | "warning" | undefined; startDate?: Date | undefined; endDate?: Date | undefined; }' is not assignable to parameter of type '{ limit?: number | undefined; offset?: number | undefined; eventType?: SecurityEventType | undefined; userId?: number | undefined; ipAddress?: string | undefined; severity?: string | undefined; success?: boolean | undefined; startDate?: Date | undefined; endDate?: Date | undefined; }'.
  Types of property 'eventType' are incompatible.
    Type 'string | undefined' is not assignable to type 'SecurityEventType | undefined'.
      Type 'string' is not assignable to type 'SecurityEventType | undefined'.
server/routes/securityMonitoring.ts(195,59): error TS2345: Argument of type '{ userId: number; offset: number; limit: number; ipAddress?: string | undefined; eventType?: string | undefined; success?: boolean | undefined; severity?: "error" | "info" | "critical" | "warning" | undefined; startDate?: Date | undefined; endDate?: Date | undefined; }' is not assignable to parameter of type '{ limit?: number | undefined; offset?: number | undefined; eventType?: SecurityEventType | undefined; userId?: number | undefined; ipAddress?: string | undefined; severity?: string | undefined; success?: boolean | undefined; startDate?: Date | undefined; endDate?: Date | undefined; }'.
  Types of property 'eventType' are incompatible.
    Type 'string | undefined' is not assignable to type 'SecurityEventType | undefined'.
      Type 'string' is not assignable to type 'SecurityEventType | undefined'.
server/routes/securityMonitoring.ts(213,39): error TS2339: Property 'endpoint' does not exist on type '{}'.
server/routes/securityMonitoring.ts(246,59): error TS2345: Argument of type '{ ipAddress: string; offset: number; limit: number; userId?: number | undefined; eventType?: string | undefined; success?: boolean | undefined; severity?: "error" | "info" | "critical" | "warning" | undefined; startDate?: Date | undefined; endDate?: Date | undefined; }' is not assignable to parameter of type '{ limit?: number | undefined; offset?: number | undefined; eventType?: SecurityEventType | undefined; userId?: number | undefined; ipAddress?: string | undefined; severity?: string | undefined; success?: boolean | undefined; startDate?: Date | undefined; endDate?: Date | undefined; }'.
  Types of property 'eventType' are incompatible.
    Type 'string | undefined' is not assignable to type 'SecurityEventType | undefined'.
      Type 'string' is not assignable to type 'SecurityEventType | undefined'.
server/routes/sessions.ts(27,38): error TS2339: Property 'jti' does not exist on type '{ id: number; name: string | null; email: string; password: string | null; plan: string; firstName: string | null; searchCount: number; lastResetDate: string; createdAt: string | null; updatedAt: string | null; ... 19 more ...; passwordStrengthScore: number; }'.
server/routes/sessions.ts(43,31): error TS2339: Property 'jti' does not exist on type '{ id: number; name: string | null; email: string; password: string | null; plan: string; firstName: string | null; searchCount: number; lastResetDate: string; createdAt: string | null; updatedAt: string | null; ... 19 more ...; passwordStrengthScore: number; }'.
server/routes/sessions.ts(64,38): error TS2339: Property 'jti' does not exist on type '{ id: number; name: string | null; email: string; password: string | null; plan: string; firstName: string | null; searchCount: number; lastResetDate: string; createdAt: string | null; updatedAt: string | null; ... 19 more ...; passwordStrengthScore: number; }'.
server/routes/sessions.ts(95,38): error TS2339: Property 'jti' does not exist on type '{ id: number; name: string | null; email: string; password: string | null; plan: string; firstName: string | null; searchCount: number; lastResetDate: string; createdAt: string | null; updatedAt: string | null; ... 19 more ...; passwordStrengthScore: number; }'.
server/routes/sessions.ts(139,38): error TS2339: Property 'jti' does not exist on type '{ id: number; name: string | null; email: string; password: string | null; plan: string; firstName: string | null; searchCount: number; lastResetDate: string; createdAt: string | null; updatedAt: string | null; ... 19 more ...; passwordStrengthScore: number; }'.
server/scripts/detectCredentials.ts(52,56): error TS2339: Property 'violations' does not exist on type '{ file: string; result: any; }'.
server/scripts/detectCredentials.ts(52,72): error TS7006: Parameter 'v' implicitly has an 'any' type.
server/services/collaboration.ts(365,5): error TS2740: Type 'Omit<PgSelectBase<"activity_feed", { id: PgColumn<{ name: "id"; tableName: "activity_feed"; dataType: "number"; columnType: "PgSerial"; data: number; driverParam: number; notNull: true; hasDefault: true; isPrimaryKey: true; ... 5 more ...; generated: undefined; }, {}, {}>; ... 8 more ...; entityId: PgColumn<...>; },...' is missing the following properties from type 'PgSelectBase<"activity_feed", { id: PgColumn<{ name: "id"; tableName: "activity_feed"; dataType: "number"; columnType: "PgSerial"; data: number; driverParam: number; notNull: true; hasDefault: true; isPrimaryKey: true; ... 5 more ...; generated: undefined; }, {}, {}>; ... 8 more ...; entityId: PgColumn<...>; }, ... ...': config, joinsNotNullableMap, tableName, isPartialSelect, and 5 more.
server/services/securityLogger.ts(288,38): error TS2769: No overload matches this call.
  Overload 1 of 3, '(left: Column<ColumnBaseConfig<ColumnDataType, string>, object, object>, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'Column<ColumnBaseConfig<ColumnDataType, string>, object, object>'.
  Overload 2 of 3, '(left: Aliased<PgColumn<{ name: "timestamp"; tableName: "security_audit_logs"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: true; hasDefault: true; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>, right: SQLWrapper | PgColumn<...>): SQL<...>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'Aliased<PgColumn<{ name: "timestamp"; tableName: "security_audit_logs"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: true; hasDefault: true; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>'.
  Overload 3 of 3, '(left: SQLWrapper, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'SQLWrapper'.
server/services/securityLogger.ts(291,7): error TS2740: Type 'Omit<PgSelectBase<"security_audit_logs", { id: PgColumn<{ name: "id"; tableName: "security_audit_logs"; dataType: "number"; columnType: "PgSerial"; data: number; driverParam: number; notNull: true; hasDefault: true; ... 6 more ...; generated: undefined; }, {}, {}>; ... 14 more ...; requestId: PgColumn<...>; }, ... 5...' is missing the following properties from type 'PgSelectBase<"security_audit_logs", { id: PgColumn<{ name: "id"; tableName: "security_audit_logs"; dataType: "number"; columnType: "PgSerial"; data: number; driverParam: number; notNull: true; hasDefault: true; ... 6 more ...; generated: undefined; }, {}, {}>; ... 14 more ...; requestId: PgColumn<...>; }, ... 5 more...': config, joinsNotNullableMap, tableName, isPartialSelect, and 5 more.
server/services/securityLogger.ts(330,38): error TS2769: No overload matches this call.
  Overload 1 of 3, '(left: Column<ColumnBaseConfig<ColumnDataType, string>, object, object>, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'Column<ColumnBaseConfig<ColumnDataType, string>, object, object>'.
  Overload 2 of 3, '(left: Aliased<PgColumn<{ name: "timestamp"; tableName: "security_alerts"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: true; hasDefault: true; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>, right: SQLWrapper | PgColumn<...>): SQL<...>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'Aliased<PgColumn<{ name: "timestamp"; tableName: "security_alerts"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: true; hasDefault: true; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>'.
  Overload 3 of 3, '(left: SQLWrapper, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'SQLWrapper'.
server/services/securityLogger.ts(333,7): error TS2740: Type 'Omit<PgSelectBase<"security_alerts", { id: PgColumn<{ name: "id"; tableName: "security_alerts"; dataType: "number"; columnType: "PgSerial"; data: number; driverParam: number; notNull: true; hasDefault: true; isPrimaryKey: true; ... 5 more ...; generated: undefined; }, {}, {}>; ... 11 more ...; notificationsSent: PgC...' is missing the following properties from type 'PgSelectBase<"security_alerts", { id: PgColumn<{ name: "id"; tableName: "security_alerts"; dataType: "number"; columnType: "PgSerial"; data: number; driverParam: number; notNull: true; hasDefault: true; isPrimaryKey: true; ... 5 more ...; generated: undefined; }, {}, {}>; ... 11 more ...; notificationsSent: PgColumn...': config, joinsNotNullableMap, tableName, isPartialSelect, and 5 more.
server/services/sessionManager.ts(96,14): error TS2769: No overload matches this call.
  Overload 1 of 3, '(left: Column<ColumnBaseConfig<ColumnDataType, string>, object, object>, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'Column<ColumnBaseConfig<ColumnDataType, string>, object, object>'.
  Overload 2 of 3, '(left: Aliased<PgColumn<{ name: "expires_at"; tableName: "jwt_tokens"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: true; hasDefault: false; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>, right: SQLWrapper | PgColumn<...>): SQL<...>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'Aliased<PgColumn<{ name: "expires_at"; tableName: "jwt_tokens"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: true; hasDefault: false; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>'.
  Overload 3 of 3, '(left: SQLWrapper, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'SQLWrapper'.
server/services/sessionManager.ts(144,16): error TS2769: No overload matches this call.
  Overload 1 of 3, '(left: Column<ColumnBaseConfig<ColumnDataType, string>, object, object>, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'Column<ColumnBaseConfig<ColumnDataType, string>, object, object>'.
  Overload 2 of 3, '(left: Aliased<PgColumn<{ name: "issued_at"; tableName: "jwt_tokens"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: true; hasDefault: false; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>, right: SQLWrapper | PgColumn<...>): SQL<...>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'Aliased<PgColumn<{ name: "issued_at"; tableName: "jwt_tokens"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: true; hasDefault: false; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>'.
  Overload 3 of 3, '(left: SQLWrapper, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'SQLWrapper'.
server/services/sessionManager.ts(267,9): error TS2393: Duplicate function implementation.
server/services/sessionManager.ts(284,14): error TS2769: No overload matches this call.
  Overload 1 of 3, '(left: Column<ColumnBaseConfig<ColumnDataType, string>, object, object>, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'Column<ColumnBaseConfig<ColumnDataType, string>, object, object>'.
  Overload 2 of 3, '(left: Aliased<PgColumn<{ name: "expires_at"; tableName: "jwt_tokens"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: true; hasDefault: false; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>, right: SQLWrapper | PgColumn<...>): SQL<...>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'Aliased<PgColumn<{ name: "expires_at"; tableName: "jwt_tokens"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: true; hasDefault: false; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>'.
  Overload 3 of 3, '(left: SQLWrapper, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'SQLWrapper'.
server/services/sessionManager.ts(296,14): error TS2769: No overload matches this call.
  Overload 1 of 3, '(left: Column<ColumnBaseConfig<ColumnDataType, string>, object, object>, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'Column<ColumnBaseConfig<ColumnDataType, string>, object, object>'.
  Overload 2 of 3, '(left: Aliased<PgColumn<{ name: "expires_at"; tableName: "jwt_tokens"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: true; hasDefault: false; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>, right: SQLWrapper | PgColumn<...>): SQL<...>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'Aliased<PgColumn<{ name: "expires_at"; tableName: "jwt_tokens"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: true; hasDefault: false; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>'.
  Overload 3 of 3, '(left: SQLWrapper, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'SQLWrapper'.
server/services/sessionManager.ts(308,14): error TS2769: No overload matches this call.
  Overload 1 of 3, '(left: Column<ColumnBaseConfig<ColumnDataType, string>, object, object>, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'Column<ColumnBaseConfig<ColumnDataType, string>, object, object>'.
  Overload 2 of 3, '(left: Aliased<PgColumn<{ name: "revoked_at"; tableName: "jwt_tokens"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: false; hasDefault: false; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>, right: SQLWrapper | PgColumn<...>): SQL<...>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'Aliased<PgColumn<{ name: "revoked_at"; tableName: "jwt_tokens"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: false; hasDefault: false; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>'.
  Overload 3 of 3, '(left: SQLWrapper, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'string' is not assignable to parameter of type 'SQLWrapper'.
server/services/sessionManager.ts(422,14): error TS2769: No overload matches this call.
  Overload 1 of 3, '(left: Column<ColumnBaseConfig<ColumnDataType, string>, object, object>, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'Date' is not assignable to parameter of type 'Column<ColumnBaseConfig<ColumnDataType, string>, object, object>'.
      Type 'Date' is missing the following properties from type 'Column<ColumnBaseConfig<ColumnDataType, string>, object, object>': table, _, name, keyAsName, and 19 more.
  Overload 2 of 3, '(left: Aliased<PgColumn<{ name: "expires_at"; tableName: "jwt_tokens"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: true; hasDefault: false; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>, right: SQLWrapper | PgColumn<...>): SQL<...>', gave the following error.
    Argument of type 'Date' is not assignable to parameter of type 'Aliased<PgColumn<{ name: "expires_at"; tableName: "jwt_tokens"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: true; hasDefault: false; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>'.
      Type 'Date' is missing the following properties from type 'Aliased<PgColumn<{ name: "expires_at"; tableName: "jwt_tokens"; dataType: "string"; columnType: "PgTimestampString"; data: string; driverParam: string; notNull: true; hasDefault: false; isPrimaryKey: false; ... 5 more ...; generated: undefined; }, {}, {}>>': sql, fieldAlias, _, getSQL
  Overload 3 of 3, '(left: SQLWrapper, right: unknown): SQL<unknown>', gave the following error.
    Argument of type 'Date' is not assignable to parameter of type 'SQLWrapper'.
      Property 'getSQL' is missing in type 'Date' but required in type 'SQLWrapper'.
server/services/sessionManager.ts(432,9): error TS2393: Duplicate function implementation.
server/storage.ts(172,7): error TS2740: Type 'Omit<PgSelectBase<"users", { id: PgColumn<{ name: "id"; tableName: "users"; dataType: "number"; columnType: "PgSerial"; data: number; driverParam: number; notNull: true; hasDefault: true; isPrimaryKey: true; isAutoincrement: false; ... 4 more ...; generated: undefined; }, {}, {}>; ... 28 more ...; passwordStrengthSc...' is missing the following properties from type 'PgSelectBase<"users", { id: PgColumn<{ name: "id"; tableName: "users"; dataType: "number"; columnType: "PgSerial"; data: number; driverParam: number; notNull: true; hasDefault: true; isPrimaryKey: true; isAutoincrement: false; ... 4 more ...; generated: undefined; }, {}, {}>; ... 28 more ...; passwordStrengthScore: ...': config, joinsNotNullableMap, tableName, isPartialSelect, and 5 more.
